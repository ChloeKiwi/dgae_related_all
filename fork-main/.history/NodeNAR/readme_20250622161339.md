# NodeNAR Official code

This repository contains the source code for the NodeNAR, a novel non-autoregressive generative framework for graph generation.

### Installation

```
pip install -r requirements.txt
```

### Run

```
bash run.sh
```

--work

Only train the encoder, quantizer and decoder at the first stage, just preserve:

```powershell
run_experiment() {
    local exp_config=$1
    read -r dataset codebook_size nc gpu mask_func iterations_rate <<< "${experiment_configs[$exp_config]}"
  
    echo "exp config: $exp_config (dataset: $dataset, GPU: $gpu, Codebook Size: $codebook_size, NC: $nc, Mask Function: $mask_func, Iterations Rate: $iterations_rate)"
   
    echo "[$exp_config] train_autoencoder begin..."
    python main.py --work_type train_autoencoder --gpu $gpu --exp_name $exp_name --run_name $exp_config --dataset $dataset --wandb $wandb --codebook_size $codebook_size --nc $nc 2>&1 | tee "models_own/$exp_name/$exp_config/${dataset}_autoencoder/$date.log"
    echo "[$exp_config] train_autoencoder done!"

#     echo "[$exp_config] train_prior begin..."
#     python main.py --work_type train_prior --gpu $gpu --exp_name $exp_name --run_name $exp_config --dataset $dataset --wandb $wandb --codebook_size $codebook_size --nc $nc --use_mask --mask_func $mask_func --iterations_rate $iterations_rate 2>&1 | tee "models_own/$exp_name/$exp_config/${dataset}_prior/$date.log"
#     echo "[$exp_config] train_prior done!"


#     echo "[$exp_config] sample begin..."
#     python main.py --work_type sample --gpu $gpu --exp_name $exp_name --run_name $exp_config --dataset $dataset  --wandb $wandb --codebook_size $codebook_size --nc $nc --use_mask --mask_func $mask_func --iterations_rate $iterations_rate 2>&1 | tee "models_own/$exp_name/$exp_config/${dataset}_sample/$date.log"
#     echo "[$exp_config] sample done!"
}
```
